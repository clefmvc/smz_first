(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-43de7884"],{"0fd2":function(e,r,t){"use strict";t("d6f8")},"6a33":function(e,r,t){"use strict";t.r(r);var s=function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("el-main",{staticClass:"bg edit_wrap comtable_e"},[e.is_view()?s("el-form",{ref:"form",attrs:{model:e.form,"status-icon":"","label-width":"120px"}},[s("el-row",{staticClass:"row_ce"},[e.$check_field("get","ordinary_user")||e.$check_field("add","ordinary_user")||e.$check_field("set","ordinary_user")?s("el-col",{staticClass:"el_form_item_warp",attrs:{xs:24,sm:12,lg:8}},[s("el-form-item",{attrs:{label:"普通用户",prop:"ordinary_user"}},["管理员"!==e.user_group?s("div",[e._v(" "+e._s(e.get_user_session_ordinary_user(e.form["ordinary_user"]))+" "),e.form["exchange_forum_id"]&&e.$check_field("set","ordinary_user")||!e.form["exchange_forum_id"]&&e.$check_field("add","ordinary_user")?s("el-select",{attrs:{id:"ordinary_user",disabled:e.disabledObj["ordinary_user_isDisabled"]},model:{value:e.form["ordinary_user"],callback:function(r){e.$set(e.form,"ordinary_user",r)},expression:"form['ordinary_user']"}},e._l(e.list_user_ordinary_user,(function(e){return s("el-option",{key:e["username"],attrs:{label:e["nickname"]+"-"+e["username"],value:e["user_id"]}})})),1):e.$check_field("get","ordinary_user")?s("el-select",{attrs:{id:"ordinary_user",disabled:!0},model:{value:e.form["ordinary_user"],callback:function(r){e.$set(e.form,"ordinary_user",r)},expression:"form['ordinary_user']"}},e._l(e.list_user_ordinary_user,(function(e){return s("el-option",{key:e["username"],attrs:{label:e["nickname"]+"-"+e["username"],value:e["user_id"]}})})),1):e._e()],1):s("el-select",{attrs:{id:"ordinary_user",disabled:e.disabledObj["ordinary_user_isDisabled"]},model:{value:e.form["ordinary_user"],callback:function(r){e.$set(e.form,"ordinary_user",r)},expression:"form['ordinary_user']"}},e._l(e.list_user_ordinary_user,(function(e){return s("el-option",{key:e["username"],attrs:{label:e["nickname"]+"-"+e["username"],value:e["user_id"]}})})),1)],1)],1):e._e(),e.$check_field("get","user_name")||e.$check_field("add","user_name")||e.$check_field("set","user_name")?s("el-col",{staticClass:"el_form_item_warp",attrs:{xs:24,sm:12,lg:8}},[s("el-form-item",{attrs:{label:"用户姓名",prop:"user_name"}},[e.form["exchange_forum_id"]&&e.$check_field("set","user_name")||!e.form["exchange_forum_id"]&&e.$check_field("add","user_name")?s("el-input",{attrs:{id:"user_name",placeholder:"请输入用户姓名",disabled:e.disabledObj["user_name_isDisabled"]},model:{value:e.form["user_name"],callback:function(r){e.$set(e.form,"user_name",r)},expression:"form['user_name']"}}):e.$check_field("get","user_name")?s("div",[e._v(e._s(e.form["user_name"]))]):e._e()],1)],1):e._e(),e.$check_field("get","user_phone")||e.$check_field("add","user_phone")||e.$check_field("set","user_phone")?s("el-col",{staticClass:"el_form_item_warp",attrs:{xs:24,sm:12,lg:8}},[s("el-form-item",{attrs:{label:"用户电话",prop:"user_phone"}},[e.form["exchange_forum_id"]&&e.$check_field("set","user_phone")||!e.form["exchange_forum_id"]&&e.$check_field("add","user_phone")?s("el-input",{attrs:{id:"user_phone",placeholder:"请输入用户电话",disabled:e.disabledObj["user_phone_isDisabled"]},model:{value:e.form["user_phone"],callback:function(r){e.$set(e.form,"user_phone",r)},expression:"form['user_phone']"}}):e.$check_field("get","user_phone")?s("div",[e._v(e._s(e.form["user_phone"]))]):e._e()],1)],1):e._e(),e.$check_field("get","user_gender")||e.$check_field("add","user_gender")||e.$check_field("set","user_gender")?s("el-col",{staticClass:"el_form_item_warp",attrs:{xs:24,sm:12,lg:8}},[s("el-form-item",{attrs:{label:"用户性别",prop:"user_gender"}},[e.form["exchange_forum_id"]&&e.$check_field("set","user_gender")||!e.form["exchange_forum_id"]&&e.$check_field("add","user_gender")?s("el-input",{attrs:{id:"user_gender",placeholder:"请输入用户性别",disabled:e.disabledObj["user_gender_isDisabled"]},model:{value:e.form["user_gender"],callback:function(r){e.$set(e.form,"user_gender",r)},expression:"form['user_gender']"}}):e.$check_field("get","user_gender")?s("div",[e._v(e._s(e.form["user_gender"]))]):e._e()],1)],1):e._e(),e.$check_field("get","forum_title")||e.$check_field("add","forum_title")||e.$check_field("set","forum_title")?s("el-col",{staticClass:"el_form_item_warp",attrs:{xs:24,sm:12,lg:8}},[s("el-form-item",{attrs:{label:"论坛标题",prop:"forum_title"}},[e.form["exchange_forum_id"]&&e.$check_field("set","forum_title")||!e.form["exchange_forum_id"]&&e.$check_field("add","forum_title")?s("el-input",{attrs:{id:"forum_title",placeholder:"请输入论坛标题",disabled:e.disabledObj["forum_title_isDisabled"]},model:{value:e.form["forum_title"],callback:function(r){e.$set(e.form,"forum_title",r)},expression:"form['forum_title']"}}):e.$check_field("get","forum_title")?s("div",[e._v(e._s(e.form["forum_title"]))]):e._e()],1)],1):e._e(),e.$check_field("get","type_of_communication")||e.$check_field("add","type_of_communication")||e.$check_field("set","type_of_communication")?s("el-col",{staticClass:"el_form_item_warp",attrs:{xs:24,sm:12,lg:8}},[s("el-form-item",{attrs:{label:"交流类型",prop:"type_of_communication"}},[e.form["exchange_forum_id"]&&e.$check_field("set","type_of_communication")||!e.form["exchange_forum_id"]&&e.$check_field("add","type_of_communication")?s("el-select",{attrs:{id:"type_of_communication"},model:{value:e.form["type_of_communication"],callback:function(r){e.$set(e.form,"type_of_communication",r)},expression:"form['type_of_communication']"}},e._l(e.list_type_of_communication,(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1):e.$check_field("get","type_of_communication")?s("div",[e._v(e._s(e.form["type_of_communication"]))]):e._e()],1)],1):e._e(),e.$check_field("get","release_date")||e.$check_field("add","release_date")||e.$check_field("set","release_date")?s("el-col",{staticClass:"el_form_item_warp",attrs:{xs:24,sm:12,lg:8}},[s("el-form-item",{attrs:{label:"发布日期",prop:"release_date"}},[e.form["exchange_forum_id"]&&e.$check_field("set","release_date")||!e.form["exchange_forum_id"]&&e.$check_field("add","release_date")?s("el-date-picker",{attrs:{disabled:e.disabledObj["release_date_isDisabled"],id:"release_date",type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.form["release_date"],callback:function(r){e.$set(e.form,"release_date",r)},expression:"form['release_date']"}}):e.$check_field("get","release_date")?s("div",[e._v(e._s(e.form["release_date"]))]):e._e()],1)],1):e._e(),e.$check_field("get","cover_image")||e.$check_field("add","cover_image")||e.$check_field("set","cover_image")?s("el-col",{staticClass:"el_form_item_warp",attrs:{xs:24,sm:12,lg:8}},[s("el-form-item",{attrs:{label:"封面图片",prop:"cover_image"}},[e.form["exchange_forum_id"]&&e.$check_field("set","cover_image")||!e.form["exchange_forum_id"]&&e.$check_field("add","cover_image")?s("el-upload",{staticClass:"avatar-uploader",attrs:{disabled:e.disabledObj["cover_image_isDisabled"],drag:"",accept:"image/gif, image/jpeg, image/png, image/jpg",action:"","http-request":e.upload_cover_image,"show-file-list":!1}},[e.form["cover_image"]?s("img",{staticClass:"avatar",attrs:{id:"cover_image",src:e.$fullUrl(e.form["cover_image"])}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]):e.$check_field("get","cover_image")?s("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.$fullUrl(e.form["cover_image"]),"preview-src-list":[e.$fullUrl(e.form["cover_image"])]}},[s("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[s("img",{staticStyle:{width:"90px",height:"90px"},attrs:{src:t("84f9")}})])]):e._e()],1)],1):e._e(),e.$check_field("get","content_details")||e.$check_field("add","content_details")||e.$check_field("set","content_details")?s("el-col",{staticClass:"el_form_item_warp",attrs:{xs:24,sm:12,lg:8}},[s("el-form-item",{attrs:{label:"内容详情",prop:"content_details"}},[e.form["exchange_forum_id"]&&e.$check_field("set","content_details")||!e.form["exchange_forum_id"]&&e.$check_field("add","content_details")?s("el-input",{attrs:{type:"textarea",id:"content_details",placeholder:"请输入内容详情",disabled:e.disabledObj["content_details_isDisabled"]},model:{value:e.form["content_details"],callback:function(r){e.$set(e.form,"content_details",r)},expression:"form['content_details']"}}):e.$check_field("get","content_details")?s("div",[e._v(e._s(e.form["content_details"]))]):e._e()],1)],1):e._e()],1),s("el-col",{staticClass:"el_form_btn_warp",attrs:{xs:24,sm:12,lg:8}},[e.$check_action("/exchange_forum/view","set")||e.$check_action("/exchange_forum/view","add")||e.$check_option("/exchange_forum/table","examine")?s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submit()}}},[e._v("提交")]),s("el-button",{on:{click:function(r){return e.cancel()}}},[e._v("取消")])],1):s("el-form-item",[s("el-button",{on:{click:function(r){return e.cancel()}}},[e._v("返回")])],1)],1)],1):e._e()],1)},a=[],i=(t("b64b"),t("159b"),t("96cf"),t("1da1")),o=t("c6e7"),_={mixins:[o["a"]],data:function(){return{field:"exchange_forum_id",url_add:"~/api/exchange_forum/add?",url_set:"~/api/exchange_forum/set?",url_get_obj:"~/api/exchange_forum/get_obj?",url_upload:"~/api/exchange_forum/upload?",query:{exchange_forum_id:0},form:{ordinary_user:0,user_name:"",user_phone:"",user_gender:"",forum_title:"",type_of_communication:"",release_date:"",cover_image:"",content_details:"",exchange_forum_id:0},disabledObj:{ordinary_user_isDisabled:!1,user_name_isDisabled:!1,user_phone_isDisabled:!1,user_gender_isDisabled:!1,forum_title_isDisabled:!1,type_of_communication_isDisabled:!1,release_date_isDisabled:!1,cover_image_isDisabled:!1,content_details_isDisabled:!1},list_user_ordinary_user:[],group_user_ordinary_user:"",list_type_of_communication:["聊天","其他"]}},methods:{get_list_user_ordinary_user:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var t;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.$get("~/api/user/get_list?user_group=普通用户");case 2:t=r.sent,t.result&&t.result.list?e.list_user_ordinary_user=t.result.list:t.error&&console.error(t.error);case 4:case"end":return r.stop()}}),r)})))()},get_group_user_ordinary_user:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var t;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.form["ordinary_user"]=e.user.user_id,r.next=3,e.$get("~/api/user_group/get_obj?name=普通用户");case 3:t=r.sent,t.result&&t.result.obj?e.group_user_ordinary_user=t.result.obj:t.error&&console.error(t.error);case 5:case"end":return r.stop()}}),r)})))()},get_user_session_ordinary_user:function(e){var r=this,t={user_id:e},s="~/api/"+r.group_user_ordinary_user.source_table+"/get_obj?";this.$get(s,t,(function(t){if(t.result&&t.result.obj){var s=[];for(var a in t.result.obj)s.push(a);var i=[];for(var o in r.form)i.push(o);r.form["ordinary_user"]=e,r.disabledObj["ordinary_user_isDisabled"]=!0;for(var _=0;_<s.length;_++)if("examine_state"!==s[_]&&"examine_reply"!==s[_])for(var l=0;l<i.length;l++)if(s[_]===i[l]){if("ordinary_user"!==s[_]){r.form[i[l]]=t.result.obj[s[_]],r.disabledObj[i[l]+"_isDisabled"]=!0;break}r.disabledObj[i[l]+"_isDisabled"]=!0}}}))},get_user_ordinary_user:function(e){var r=this.list_user_ordinary_user.getObj({user_id:e}),t="";return r&&(t=r.nickname?r.nickname:r.username),t},upload_cover_image:function(e){this.uploadFile(e.file,"cover_image")},get_obj_before:function(e){var r=this,t="";return this.form&&t&&Object.keys(this.form).forEach((function(e){Object.keys(t).forEach((function(s){e===s&&(r.disabledObj[e+"_isDisabled"]=!0,r.form[e]=t[s]),"source_table"===s&&(r.form["source_table"]=t[s]),"source_id"===s&&(r.form["source_id"]=t[s]),"source_user_id"===s&&(r.form["source_user_id"]=t[s])}))})),this.form["release_date"]&&-1===this.form["release_date"].indexOf("-")&&(this.form["release_date"]=this.$toTime(parseInt(this.form["release_date"]),"yyyy-MM-dd")),$.db.del("form"),e},get_obj_after:function(e,r){"0000-00-00"==this.form["release_date"]&&(this.form["release_date"]=null),parseInt(this.form["release_date"])>9999&&(this.form["release_date"]=this.$toTime(parseInt(this.form["release_date"]),"yyyy-MM-dd"))},submit:function(e,r){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var a,i,o;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e||(e=t.form),a=t.events("submit_before",Object.assign({},e))||e,s.next=4,t.events("submit_check",a);case 4:return i=s.sent,i?t.$toast(i,"danger"):o=t.events("submit_main",a,r),s.abrupt("return",o);case 7:case"end":return s.stop()}}),s)})))()},submit_check:function(e){return e.release_date?null:"发布日期不能为空"},is_view:function(){var e=!1;return e||(e=this.$check_action("/exchange_forum/table","add"),console.log(e?"你有表格添加权限视作有添加权限":"你没有表格添加权限")),e||(e=this.$check_action("/exchange_forum/table","set"),console.log(e?"你有表格添加权限视作有修改权限":"你没有表格修改权限")),e||(e=this.$check_action("/exchange_forum/view","add"),console.log(e?"你有视图添加权限视作有添加权限":"你没有视图添加权限")),e||(e=this.$check_action("/exchange_forum/view","set"),console.log(e?"你有视图修改权限视作有修改权限":"你没有视图修改权限")),e||(e=this.$check_action("/exchange_forum/view","get"),console.log(e?"你有视图查询权限视作有查询权限":"你没有视图查询权限")),console.log(e?"具有当前页面的查看权，请注意这不代表你有字段的查看权":"无权查看当前页，请注意即便有字段查询权限没有页面查询权限也不行"),e},uploadimg:function(e){this.uploadFile(e.file,"avatar")}},created:function(){this.get_list_user_ordinary_user(),this.get_group_user_ordinary_user()}},l=_,n=(t("0fd2"),t("2877")),c=Object(n["a"])(l,s,a,!1,null,null,null);r["default"]=c.exports},d6f8:function(e,r,t){}}]);